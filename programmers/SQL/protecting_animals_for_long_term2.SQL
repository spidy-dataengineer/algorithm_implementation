SELECT C.ANIMAL_ID,
       C.NAME
FROM (
    SELECT A.ANIMAL_ID,
           A.NAME,
           ROW_NUMBER() OVER(ORDER BY (B.DATETIME - A.DATETIME) DESC) AS DRN
    FROM ANIMAL_INS A
    INNER JOIN ANIMAL_OUTS B
    ON A.ANIMAL_ID=B.ANIMAL_ID
    ) C
WHERE C.DRN <= 2;